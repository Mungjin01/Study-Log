
## Thread

: 프로세스의 작업 흐름

싱글스레드 → 한 번에 하나의 작업만 수행

멀티스레드 → 동시에 여러 작업을 수행

![스레드1-1.PNG](https://i.esdrop.com/d/f/AfOYjCl4ON/vB20nrggHe.png)

- 서버에게 서비스 요청이 들어오면 프로세스는 그 요청을 수행할 별도의 프로세스를 생성
- but 프로세스 생성 작업은 많은 시간과 자원을 소비해야 하므로 오버헤드가 많아짐 → 프로세스 안에서 여러 스레드 만들어나가는 것이 효율적이다.
- 커널 안에서 다수의 스레드들이 동작하고 각 스레드는 인터럽트 처리 등 작업 수행

멀티스레드 프로그래밍 장점 4가지

1. 응답성
    1. interactive application을 멀티스레딩하면 일부분이 blocking되거나 긴 작업을 수행해도 프로그램의 수행이 계속되도록 해서 responsivess 향상
2. 자원 공유
    1. 공유 메모리와 메시지 전달 기법을 통해 자원 공유
    2. → 같은 address space 내에 여러 개의 다른 작업을 하는 Thread를 가질 수 있다
3. 경제성
    1. 자신이 속한 process의 자원들을 공유하기에 thread를 생성하여 context-switch하는 것이 경제적
4. 규모 적응성

## 다중 코어 프로그래밍

멀티코어 시스템안의 멀티쓰레딩

- 동시성 개선

- single-core: 쓰레들들 시산이 지남에 따라 interleaved해서 쓰레드들 중간에 공백의 시간 존재
    
    ![스레드와동시성 1-1.PNG](https://i.esdrop.com/d/f/AfOYjCl4ON/b3Gme1IL8h.png)
    
- multiple-cores: 여러 개의 쓰레드들이 병렬적으로 수행ㄱㄴ
    
    ![스레드와동시성 1-2.PNG](https://i.esdrop.com/d/f/AfOYjCl4ON/ScCUSIsBWa.png)
    

**Multicore systems에서 프로그래밍 도전**

- 테스크 식별 → 테스크를 나누어 수행할 영역 찾기
- 균형 → 동일한 가치의 작업 수행할 수 있도록 보장
- 데이터 분할 → 데이터 또한 여러 개의 코어가 놓지 않도록 잘 나누기
- 데이터 의존성: 데이터 의존성을 수용하도록 테스크의 실행이 동기화
- 데스트와 디버깅

**병렬 실행의 유형**

1. 데이터 병렬 실행

→ 동일한 data의 부분 집합을 다수의 계산 코어에 분배해서 각 코어에서 동일한 연산 수행

1. 태스크 병렬 실행

→ data가 아닌 task를 다수의 코어에 분배

⇒ data parallelism은 data가 core에 분배되어야 하고 task parallesim은 task가 분배

## 다중 쓰레드 모델

- 다대일 모델(Many-to-One Model)
- 일대일 모델(One-to-One Model)
- 다대다 모델(Many-to-Many Model)
- 다대다 모델의 변형, 두 수준 모델(Two-Level Model)

### 1. 다대일 모델

- 여러 개의 사용자 수준 쓰레드를 하나의 커널 쓰레드에 매핑
- 하나의 사용자 쓰레드가 블록되면 전체 프로세스가 봉쇄
- 다중 쓰레드가 다중 처리기에서 수행되어도 병렬로 작동 불가능

![스레드와동시성 1-3.PNG](https://i.esdrop.com/d/f/AfOYjCl4ON/pxZz1v9TOq.png)

### 2. 일대일 모델

- 각각의 사용자 쓰레드가 각각의 커널 쓰레드에 매핑
- 하나의 쓰레드가 블록되어도 다른 쓰레드가 수행 가능하기 때문에 많은 병렬성 제공
- 다중 처리기에서 다중 쓰레드가 병렬로 수행되는 것을 허용

but 사용자 쓰레드를 생성할 때 커널 쓰레드도 생성되기에 응용 프로그램 성능 정하됨

![스레드와동시성 1-4.PNG](https://i.esdrop.com/d/f/AfOYjCl4ON/mZzq3Ycqxx.png)

### 3. 다대다 모델

- 여러 개의 사용자 수준 쓰레드를 그보다 작거나 같은 수의 커널 쓰레드로 매핑
- 하나의 사용자 쓰레드가 블록되어도 다른 사용자 쓰레드 실행 ㄱㄴ
- 개발자가 필요한 만큼의 사용자 쓰레드 생성 ㄱㄴ

![스레드와동시성 1-5.PNG](https://i.esdrop.com/d/f/AfOYjCl4ON/0E8EqcCnuR.png)

### 4. 두 수준 모델

- 하나의 사용자 쓰레드가 하나의 커널 쓰레드에 종속되도록 함
- 다대다 모델의 변형

![스레드와동시성 1-6.PNG](https://i.esdrop.com/d/f/AfOYjCl4ON/b3Gme1IL8h.png)